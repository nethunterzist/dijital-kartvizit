MANUAL DEPLOYMENT COMMANDS FOR HETZNER SERVER

1. Connect to server via SSH (use Hetzner Console Web SSH):
   
2. Run these commands one by one:

# Stop any existing services
pm2 stop all 2>/dev/null || true
pm2 delete all 2>/dev/null || true

# Create app directory
mkdir -p /opt/dijital-kartvizit
cd /opt/dijital-kartvizit

# Install Node.js 20 if not exists
curl -fsSL https://deb.nodesource.com/setup_20.x | bash -
apt-get install -y nodejs

# Install PM2 globally
npm install -g pm2

# Clone or upload the project (Manual upload required)
# You need to upload dijital-kartvizit.tar.gz to /tmp/ first

# Extract project
tar -xzf /tmp/dijital-kartvizit.tar.gz

# Set environment variables
export NODE_ENV=production
export DATABASE_URL="postgresql://postgres:v1JuQjXhW6g23DdR7TVpFz4z0aanP5uGGzXf2r0GPphCa71fF7qoIj6z197rjR34@46.62.171.65:5432/dijitalkartvizit?sslmode=disable"
export NEXTAUTH_URL="https://fowksko404s008ogkg4gw0gk.46.62.171.65.sslip.io"
export NEXTAUTH_SECRET="your_secret_key_here"

# Install dependencies
npm install

# Generate Prisma client
npx prisma generate

# Build application
npm run build

# Start with PM2
pm2 start npm --name "dijital-kartvizit" -- start
pm2 save
pm2 startup

# Check if running
pm2 status
pm2 logs dijital-kartvizit

# Test the application
curl localhost:3000

# If all good, setup nginx (optional)
apt update && apt install -y nginx

# Create basic nginx config
cat > /etc/nginx/sites-available/dijital-kartvizit << 'EOF'
server {
    listen 80;
    server_name fowksko404s008ogkg4gw0gk.46.62.171.65.sslip.io;
    
    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
}
EOF

# Enable site
ln -sf /etc/nginx/sites-available/dijital-kartvizit /etc/nginx/sites-enabled/
rm -f /etc/nginx/sites-enabled/default

# Test and reload nginx
nginx -t && systemctl reload nginx

echo "âœ… DEPLOYMENT COMPLETE!"
echo "ðŸŒ App should be available at: http://fowksko404s008ogkg4gw0gk.46.62.171.65.sslip.io"