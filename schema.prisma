generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model admins {
  id         Int      @id @default(autoincrement())
  username   String   @unique
  password   String
  created_at DateTime @default(now())
}

model firmalar {
  id                    Int      @id @default(autoincrement())
  firma_adi             String
  slug                  String   @unique
  profil_foto           String?
  vcard_dosya           String?
  yetkili_adi           String?
  yetkili_pozisyon      String?
  created_at            DateTime @default(now())
  updated_at            DateTime @default(now())
  goruntulenme          Int      @default(0)
  katalog               String?
  firma_hakkinda        String?
  firma_hakkinda_baslik String?  @default("Hakkımızda")
  firma_unvan           String?
  firma_vergi_no        String?
  vergi_dairesi         String?
  sektor_id             Int?
  kategori_id           Int?
  il_id                 Int?
  ilce_id               Int?
  onay                  Boolean  @default(false)
  tip                   String?
  firma_logo            String?
  template_id           Int      @default(1)

  // İlişkiler
  iletisim_bilgileri    IletisimBilgisi[]
  sosyal_medya_hesaplari SosyalMedyaHesabi[]
  banka_hesaplari       BankaHesabi[]
  
  // Foreign key ilişkileri
  sektor                sektorler?    @relation(fields: [sektor_id], references: [id])
  kategori              kategoriler?  @relation(fields: [kategori_id], references: [id])
  il                    iller?        @relation(fields: [il_id], references: [id])
  ilce                  ilceler?      @relation(fields: [ilce_id], references: [id])
}

// İletişim bilgileri tablosu
model IletisimBilgisi {
  id        Int      @id @default(autoincrement())
  firma_id  Int
  tip       String   // 'telefon', 'eposta', 'whatsapp', 'telegram', 'website', 'harita'
  deger     String   // Telefon numarası, email, URL vb.
  etiket    String?  // Opsiyonel etiket (örn: "İş Telefonu", "Genel Müdür")
  aktif     Boolean  @default(true)
  sira      Int      @default(0) // Gösterim sırası
  created_at DateTime @default(now())
  
  firma     firmalar @relation(fields: [firma_id], references: [id], onDelete: Cascade)
  
  @@index([firma_id])
  @@index([tip])
}

// Sosyal medya hesapları tablosu
model SosyalMedyaHesabi {
  id        Int      @id @default(autoincrement())
  firma_id  Int
  platform  String   // 'instagram', 'facebook', 'twitter', 'linkedin', 'youtube', 'tiktok'
  url       String   // Sosyal medya hesap URL'si
  etiket    String?  // Opsiyonel etiket
  aktif     Boolean  @default(true)
  sira      Int      @default(0) // Gösterim sırası
  created_at DateTime @default(now())
  
  firma     firmalar @relation(fields: [firma_id], references: [id], onDelete: Cascade)
  
  @@index([firma_id])
  @@index([platform])
}

// Banka hesapları tablosu
model BankaHesabi {
  id           Int      @id @default(autoincrement())
  firma_id     Int
  banka_adi    String   // Banka adı (örn: "Ziraat Bankası")
  banka_kodu   String?  // Banka kodu (opsiyonel)
  banka_logo   String?  // Banka logo URL'si
  hesap_sahibi String   // Hesap sahibi adı
  aktif        Boolean  @default(true)
  sira         Int      @default(0) // Gösterim sırası
  created_at   DateTime @default(now())
  
  firma        firmalar @relation(fields: [firma_id], references: [id], onDelete: Cascade)
  hesaplar     BankaHesapDetay[]
  
  @@index([firma_id])
}

// Banka hesap detayları tablosu (bir bankada birden fazla hesap olabilir)
model BankaHesapDetay {
  id              Int      @id @default(autoincrement())
  banka_hesabi_id Int
  iban            String   // IBAN numarası
  para_birimi     String   @default("TRY") // Para birimi (TRY, USD, EUR)
  hesap_turu      String?  // Hesap türü (opsiyonel)
  aktif           Boolean  @default(true)
  created_at      DateTime @default(now())
  
  banka_hesabi    BankaHesabi @relation(fields: [banka_hesabi_id], references: [id], onDelete: Cascade)
  
  @@index([banka_hesabi_id])
  @@index([iban])
}

model Icon {
  id       Int    @id @default(autoincrement())
  name     String
  priority Int
}

model sektorler {
  id       Int        @id @default(autoincrement())
  ad       String
  firmalar firmalar[]
}

model kategoriler {
  id       Int        @id @default(autoincrement())
  ad       String
  firmalar firmalar[]
}

model iller {
  id       Int        @id @default(autoincrement())
  ad       String
  firmalar firmalar[]
  ilceler  ilceler[]
}

model ilceler {
  id       Int        @id @default(autoincrement())
  ad       String
  il_id    Int
  il       iller      @relation(fields: [il_id], references: [id])
  firmalar firmalar[]
  
  @@index([il_id])
}
